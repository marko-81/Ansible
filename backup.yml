---
- name: Backup HTTP configuration from Linux servers and push it to GIT
  hosts: centos
  become: yes
  tasks:
    - name: Prepare remote config directory
      copy:
        src: /etc/httpd
        dest: /home/ansible/
        remote_src: yes 
    - name: Create a zip archive of config folder
      archive:
        path: /etc/httpd/
        dest: /home/ansible/httpd.zip
        
    - name: Copy  config folder to a local GIT repo
      fetch:
        src: /home/ansible/httpd.zip
        dest: /home/ansible/backup/{{ inventory_hostname }}/
        flat: yes
        
        
    
      
